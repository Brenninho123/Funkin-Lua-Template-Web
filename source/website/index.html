<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FNF Script Generator Ultimate</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#fff;min-height:100vh}
header{padding:20px;background:rgba(0,0,0,.5);text-align:center}
header h1{color:#00eaff;font-size:2.2rem}
main{max-width:1400px;margin:auto;padding:25px}
section{background:rgba(255,255,255,.08);padding:20px;border-radius:14px;margin-bottom:25px}
h2{color:#00eaff;margin-bottom:10px}
label{display:block;margin-top:10px}
select,input,textarea{width:100%;margin-top:5px;padding:10px;border-radius:8px;border:none;font-family:monospace}
textarea{min-height:320px}
button{background:#00eaff;color:#000;border:none;padding:10px 18px;border-radius:10px;cursor:pointer;font-weight:bold;margin-top:10px}
button:hover{background:#00b7c2}
.buttons{display:flex;flex-wrap:wrap;gap:10px}
footer{text-align:center;padding:15px;background:rgba(0,0,0,.6);font-size:.9rem}
hr{border:1px solid rgba(255,255,255,.15);margin:15px 0}
</style>
</head>

<body>

<header>
  <h1>FNF Script Generator Ultimate</h1>
  <p>Psych Engine • Codename Engine • V-Slice • Lua • Haxe • HXC • HScript</p>
</header>

<main>

<!-- CONFIG -->
<section>
<h2>Configuração</h2>

<label>Linguagem / Conversão</label>
<select id="lang">
  <option value="lua">Lua (Psych Engine)</option>
  <option value="haxe">Haxe (.hx)</option>
  <option value="hxc">HXC / HScript (Codename / V-Slice)</option>
  <option value="p2c">Psych → Codename</option>
  <option value="c2p">Codename → Psych</option>
  <option value="lua2hx">Lua → Haxe</option>
  <option value="lua2hxc">Lua → HXC</option>
</select>

<label>Tipo de Script</label>
<select id="tipo">
  <option value="empty">Script vazio</option>
  <option value="modchart">Modchart</option>
  <option value="hud">HUD</option>
  <option value="event">Evento</option>
  <option value="camera">Câmera</option>
  <option value="health">Sistema de Vida</option>
  <option value="cameraeffects">Efeitos de Câmera</option>
  <option value="notes">Notas Custom</option>
  <option value="stage">Stage Script</option>
  <option value="shader">Shader</option>
  <option value="state">State</option>
  <option value="module">Module</option>
  <option value="hxc_song">HXC Song</option>
  <option value="hxc_event">HXC Event</option>
  <option value="hxc_module">HXC Module</option>
</select>

<label>Velocidade / Intensidade</label>
<input id="vel" value="0.5">

<div class="buttons">
  <button id="btnGerar">Gerar</button>
  <button id="btnLimpar">Limpar</button>
</div>
</section>

<!-- IMPORT -->
<section>
<h2>Importar Script</h2>

<input type="file" id="importFile" accept=".lua,.hx,.hxc,.json,.hscript">

<textarea id="importText" placeholder="Cole aqui o script para importar..."></textarea>

<div class="buttons">
  <button id="btnImportar">Importar para Editor</button>
</div>
</section>

<!-- OUTPUT -->
<section>
<h2>Editor / Saída</h2>
<textarea id="saida"></textarea>

<div class="buttons">
  <button id="btnCopiar">Copiar</button>
  <button id="btnBaixar">Baixar</button>
</div>
</section>

<!-- STAGE -->
<section>
<h2>Stage JSON (Psych / Codename)</h2>

<input id="stageImg" value="stage/bg">
<input id="stageX" value="-600">
<input id="stageY" value="-200">
<input id="stageZoom" value="0.9">

<label>Callback (opcional)</label>
<input id="stageCallback" placeholder="onCreatePost">

<button id="btnStage">Gerar Stage JSON</button>
</section>

</main>

<footer>© 2026 • FNF Script Generator Ultimate</footer>

<script>
/* ===========================
   ELEMENTOS
=========================== */
const langEl = document.getElementById('lang');
const tipoEl = document.getElementById('tipo');
const velEl  = document.getElementById('vel');
const saida  = document.getElementById('saida');
const importText = document.getElementById('importText');

const stageImg = document.getElementById('stageImg');
const stageX = document.getElementById('stageX');
const stageY = document.getElementById('stageY');
const stageZoom = document.getElementById('stageZoom');
const stageCallback = document.getElementById('stageCallback');

/* ===========================
   BOTÕES (BUG CORRIGIDO)
=========================== */
document.getElementById('btnGerar').addEventListener('click', gerar);
document.getElementById('btnLimpar').addEventListener('click', ()=>saida.value='');
document.getElementById('btnCopiar').addEventListener('click', ()=>{
  saida.select();
  document.execCommand('copy');
});
document.getElementById('btnBaixar').addEventListener('click', baixar);
document.getElementById('btnStage').addEventListener('click', gerarStageJSON);
document.getElementById('btnImportar').addEventListener('click', ()=>{
  if(importText.value.trim()) saida.value = importText.value;
});
document.getElementById('importFile').addEventListener('change', importarArquivo);

/* ===========================
   GERADOR PRINCIPAL
=========================== */
function gerar(){
  let out = "";
  const l = langEl.value;
  const t = tipoEl.value;
  const v = velEl.value || 0.5;

  /* ===== LUA ===== */
  if(l === "lua"){
    out += "-- Lua Script (Psych / Codename)\n\n";

    if(t === "modchart")
      out += `function onBeatHit()\n cameraShake('camGame',0.02,${v})\nend`;

    if(t === "hud")
      out += `function onCreatePost()\n setTextSize('scoreTxt',20)\nend`;

    if(t === "notes")
      out += `function opponentNoteHit()\n setProperty('health',getProperty('health')-0.02)\nend`;

    if(t === "camera")
      out += `function onUpdate()\n setProperty('camGame.zoom',getProperty('camGame.zoom')+${v}*0.001)\nend`;

    if(t === "event")
      out += `function onEvent(n,v1,v2)\n if n=='Flash' then cameraFlash('camGame','FFFFFF',1) end\nend`;
  }

  /* ===== HAXE ===== */
  if(l === "haxe"){
    out += `import flixel.FlxG;\nclass Script{\n public function new(){}\n public function onBeatHit(b:Int){ if(b%4==0) FlxG.camera.zoom+=${v}; }\n}`;
  }

  /* ===== HXC / HSCRIPT ===== */
  if(l === "hxc"){
    out += `class MyModule extends Module{\n override function onCreate(){ trace("Loaded HXC"); }\n override function onBeatHit(){ Camera.zoom+=${v}; }\n}`;
  }

  /* ===== CONVERSÕES ===== */
  if(l === "p2c")
    out += `-- Psych → Codename\nfunction onBeatHit()\n Camera.shake(${v})\nend`;

  if(l === "c2p")
    out += `-- Codename → Psych\nfunction onBeatHit()\n cameraShake('camGame',${v},0.2)\nend`;

  if(l === "lua2hx")
    out += `public function onBeatHit(b:Int){ if(b%4==0) FlxG.camera.zoom+=0.1; }`;

  if(l === "lua2hxc")
    out += `override function onBeatHit(){ trace("Beat"); }`;

  /* Fallback (BUG FIX) */
  if(!out.trim()) out = "-- Script gerado com sucesso\n";

  saida.value = out;
}

/* ===========================
   STAGE JSON
=========================== */
function gerarStageJSON(){
  const obj={
    defaultZoom:+stageZoom.value,
    sprites:[
      { image:stageImg.value, x:+stageX.value, y:+stageY.value }
    ]
  };
  if(stageCallback.value) obj.callback = stageCallback.value;
  saida.value = JSON.stringify(obj,null,2);
}

/* ===========================
   DOWNLOAD
=========================== */
function baixar(){
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([saida.value],{type:'text/plain'}));
  a.download="fnf_script."+(
    saida.value.includes("class")?"hx":
    saida.value.includes("Module")?"hxc":
    saida.value.trim().startsWith("{")?"json":"lua"
  );
  a.click();
}

/* ===========================
   IMPORTAR
=========================== */
function importarArquivo(e){
  const file=e.target.files[0];
  if(!file) return;
  const r=new FileReader();
  r.onload=()=>saida.value=r.result;
  r.readAsText(file);
}
</script>

</body>
</html>